<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Normality</title>

<style>
body{
font-family:Arial;
text-align:center;
background:#eee;
}

canvas{
background:white;
border:1px solid black;
}

.controls{
margin:10px;
}
</style>
</head>

<body>

<h2>Normal Distribution</h2>

<div class="controls">
Mean:
<input id="mean" type="number" value="12" step="0.1">
Std Dev:
<input id="std" type="number" value="2" step="0.1">
</div>

<canvas id="graph" width="900" height="400"></canvas>

<div class="controls">
Left Domain:
<input id="leftBox" type="number" step="0.1">
Right Domain:
<input id="rightBox" type="number" step="0.1">
</div>

<div class="controls">
<input id="leftSlider" type="range" min="0" max="1000" value="400">
<input id="rightSlider" type="range" min="0" max="1000" value="600">
</div>

<h3 id="prob"></h3>

<script>

const ctx = document.getElementById("graph").getContext("2d");

let meanBox = document.getElementById("mean");
let stdBox = document.getElementById("std");
let leftBox = document.getElementById("leftBox");
let rightBox = document.getElementById("rightBox");
let leftSlider = document.getElementById("leftSlider");
let rightSlider = document.getElementById("rightSlider");
let probText = document.getElementById("prob");

const BASE = 350;
const HEIGHT = 300;

function pdf(x,m,s){
return 1/(s*Math.sqrt(2*Math.PI))*Math.exp(-((x-m)**2)/(2*s*s));
}

function erf(x){
let sign=x>=0?1:-1;
x=Math.abs(x);
let a1=0.254829592,a2=-0.284496736,a3=1.421413741,
a4=-1.453152027,a5=1.061405429,p=0.3275911;
let t=1/(1+p*x);
let y=1-(((((a5*t+a4)*t+a3)*t+a2)*t+a1)*t*Math.exp(-x*x));
return sign*y;
}

function cdf(x,m,s){
return 0.5*(1+erf((x-m)/(s*Math.sqrt(2))));
}

function redraw(){

let m=parseFloat(meanBox.value);
let s=parseFloat(stdBox.value);
if(s<=0)return;

let minX=m-4*s;
let maxX=m+4*s;

let left=minX+(leftSlider.value/1000)*(maxX-minX);
let right=minX+(rightSlider.value/1000)*(maxX-minX);

ctx.clearRect(0,0,900,400);

let maxPdf=pdf(m,m,s);

// ---------- CURVE ----------
ctx.beginPath();
for(let i=0;i<400;i++){
let x=minX+(i/399)*(maxX-minX);
let y=pdf(x,m,s);
let sx=(x-minX)/(maxX-minX)*900;
let sy=BASE-(y/maxPdf)*HEIGHT;
if(i==0)ctx.moveTo(sx,sy);
else ctx.lineTo(sx,sy);
}
ctx.stroke();

// ---------- SHADED REGION ----------
ctx.fillStyle="rgba(255,0,0,0.3)";
ctx.beginPath();
let started=false;

for(let i=0;i<400;i++){
let x=minX+(i/399)*(maxX-minX);

if(x>=left && x<=right){

let y=pdf(x,m,s);
let sx=(x-minX)/(maxX-minX)*900;
let sy=BASE-(y/maxPdf)*HEIGHT;

if(!started){
ctx.moveTo(sx,BASE);
ctx.lineTo(sx,sy);
started=true;
}else{
ctx.lineTo(sx,sy);
}
}
}

let rightScreen=(right-minX)/(maxX-minX)*900;
ctx.lineTo(rightScreen,BASE);
ctx.closePath();
ctx.fill();

// ---------- AXIS ----------
ctx.beginPath();
ctx.moveTo(0,BASE);
ctx.lineTo(900,BASE);
ctx.stroke();

// ---------- μ AND σ TICKS ----------
ctx.textAlign="center";
ctx.fillStyle="black";     
ctx.font="14px Arial";     

for(let i=-3;i<=3;i++){

let x=m+i*s;
let sx=(x-minX)/(maxX-minX)*900;

ctx.beginPath();
ctx.moveTo(sx,BASE);
ctx.lineTo(sx,BASE+10);
ctx.stroke();

let label = i==0 ? "μ" : (i>0?"+":"")+i+"σ";
ctx.fillText(label,sx,BASE+25);

let val = x.toFixed(2);
ctx.fillText(val,sx,BASE+40);
}

// ---------- PROBABILITY ----------
let p=cdf(right,m,s)-cdf(left,m,s);
probText.innerText="Probability: "+p.toFixed(4);

// ---------- TEXTBOX UPDATE ----------
leftBox.value=left.toFixed(2);
rightBox.value=right.toFixed(2);

}

// -------- SLIDER EVENTS --------
leftSlider.oninput=redraw;
rightSlider.oninput=redraw;

// -------- ENTER / BLUR TEXTBOX --------
leftBox.onchange=()=>{
let m=parseFloat(meanBox.value);
let s=parseFloat(stdBox.value);
let minX=m-4*s;
let maxX=m+4*s;
leftSlider.value=(leftBox.value-minX)/(maxX-minX)*1000;
redraw();
};

rightBox.onchange=()=>{
let m=parseFloat(meanBox.value);
let s=parseFloat(stdBox.value);
let minX=m-4*s;
let maxX=m+4*s;
rightSlider.value=(rightBox.value-minX)/(maxX-minX)*1000;
redraw();
};

meanBox.onchange=redraw;
stdBox.onchange=redraw;

redraw();

</script>

</body>
</html>

